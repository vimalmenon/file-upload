name: Docker Image CI

on:
  push:
    branches: [ "test" ]

env:
  PORT: 8000
  DYNAMO_DB_Table: ${{secrets.ACCESS_KEY}}
  S3_BUCKET: ${{secrets.S3_BUCKET}}
  USER_POOL_ID: ${{secrets.USER_POOL_ID}}
  CLIENT_ID: ${{secrets.CLIENT_ID}}

jobs:

  build:

    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v3
    - name: Build the Docker image
      run: docker build .  --tag my-image-name:$(date +%s) \ 
        --build-arg PORT=${{ env.APP_NAME }} \
        --build-arg DYNAMO_DB_Table=${{ env.DYNAMO_DB_Table }} \
        --build-arg S3_BUCKET=${{ env.S3_BUCKET }} \
        --build-arg USER_POOL_ID=${{ env.USER_POOL_ID }} \
        --build-arg CLIENT_ID=${{ env.CLIENT_ID }}
